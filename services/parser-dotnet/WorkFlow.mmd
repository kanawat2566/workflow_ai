flowchart TD
    START([ðŸš€ à¹€à¸£à¸´à¹ˆà¸¡: feat/parser-dotnet]) --> P0

    subgraph P0["ðŸ“ Phase 0 â€” Project Setup"]
        P0A["1.1 à¸ªà¸£à¹‰à¸²à¸‡ Parser.sln\n+ Parser.API.csproj\n+ Parser.Tests.csproj"]
        P0B["1.2 à¹€à¸žà¸´à¹ˆà¸¡ NuGet packages\nRoslyn + xUnit + Moq\n+ coverlet"]
        P0A --> P0B
    end

    P0 --> P1

    subgraph P1["ðŸ“¦ Phase 1 â€” Models & Interfaces"]
        P1A["1.3 ChunkDto.cs\n(à¸•à¸²à¸¡ chunk_schema.json)"]
        P1B["1.4 RouteEntry.cs\nParseStats.cs\nRequest/Response models"]
        P1C["1.5 IRoslynParserService.cs\nIRouteMapService.cs\n(Interfaces à¸ªà¸³à¸«à¸£à¸±à¸š DI)"]
        P1A --> P1B --> P1C
    end

    P1 --> P2

    subgraph P2["âš™ï¸ Phase 2 â€” Services (Core Logic)"]
        P2A["1.6 RoslynParserService.cs\nâ€¢ Parse C# Controllers\nâ€¢ Parse ViewModels / EF Models\nâ€¢ Parse Razor .cshtml\nâ€¢ Parse JS functions + $.ajax"]
        P2B["1.7 RouteMapService.cs\nâ€¢ Extract MVC routes\nâ€¢ Map Controllerâ†’Actionâ†’View"]
        P2A --> P2B
    end

    P2 --> P3

    subgraph P3["ðŸŒ Phase 3 â€” API Layer"]
        P3A["1.8 ParseController.cs\nPOST /parse/repo\nPOST /parse/file\nGET  /parse/routes\nPOST /parse/incremental"]
        P3B["1.9 HealthController.cs\nGET /health â†’ {status: ok}"]
        P3C["1.10 Program.cs\nDI setup + port 5100\nGlobal Exception Middleware\n#nullable enable"]
        P3A --> P3C
        P3B --> P3C
    end

    P3 --> P4

    subgraph P4["ðŸ§ª Phase 4 â€” Tests (â‰¥70% coverage)"]
        P4A["1.11 Unit/RoslynParserServiceTests.cs\nâ€¢ ParseFileAsync_WithHttpPost_...\nâ€¢ ParseFileAsync_WithEmptyFile_...\nâ€¢ [Theory] HttpGet/Post/Put/Delete"]
        P4B["1.12 Unit/RouteMapServiceTests.cs\nâ€¢ ExtractRoutes_WithAreaAttribute_...\nâ€¢ ExtractRoutes_WithNoController_..."]
        P4C["1.13 Unit/ChunkValidatorTests.cs\nâ€¢ ValidateChunk_EmptyContent_Throws\nâ€¢ ValidateChunk_ValidData_ReturnsTrue"]
        P4D["1.14 Integration/ParseControllerTests.cs\nâ€¢ WebApplicationFactory\nâ€¢ POST /parse/file â†’ 200 + chunks\nâ€¢ POST /parse/repo â†’ routeMap"]
        P4A --> P4D
        P4B --> P4D
        P4C --> P4D
    end

    P4 --> P5

    subgraph P5["ðŸ³ Phase 5 â€” Docker & Contract"]
        P5A["1.15 à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š dotnet.Dockerfile\nbuild à¸ªà¸³à¹€à¸£à¹‡à¸ˆà¹ƒà¸™ local"]
        P5B["1.16 tests/contract/validate_schema.sh\nà¸•à¸£à¸§à¸ˆ output vs chunk_schema.json"]
        P5A --> P5B
    end

    P5 --> GIT

    subgraph GIT["ðŸ” Git Loop"]
        G1["git add + commit\nfeat/parser-dotnet"]
        G2{"CI Pass?\n6 Gates"}
        G3["âŒ Fix:\nFormat / Build\nTest / Coverage"]
        G4["âœ… à¹€à¸›à¸´à¸” PR\nfeat/parser-dotnet â†’ main"]
        G5{"Quality Gate\nPass?"}
        G6["âœ… Merge to main"]
        G1 --> G2
        G2 -->|à¹„à¸¡à¹ˆà¸œà¹ˆà¸²à¸™| G3
        G3 --> G1
        G2 -->|à¸œà¹ˆà¸²à¸™| G4
        G4 --> G5
        G5 -->|à¹„à¸¡à¹ˆà¸œà¹ˆà¸²à¸™| G3
        G5 -->|à¸œà¹ˆà¸²à¸™| G6
    end

    G6 --> DONE([âœ… Parser Service à¸žà¸£à¹‰à¸­à¸¡à¹ƒà¸Šà¹‰à¸‡à¸²à¸™\nport 5100])
